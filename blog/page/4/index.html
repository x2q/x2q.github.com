
<!DOCTYPE html>
<!--[if IEMobile 7 ]><html class="no-js iem7"><![endif]-->
<!--[if lt IE 9]><html class="no-js lte-ie8"><![endif]-->
<!--[if (gt IE 8)|(gt IEMobile 7)|!(IEMobile)|!(IE)]><!--><html class="no-js" lang="en"><!--<![endif]-->
<head>
  <meta charset="utf-8">
  <title>x2q dot net</title>
  <meta name="author" content="x2q">

  
  <meta name="description" content="This script shows the Top 10 worst performing indexes (in terms of selectivity %) on the whole MySQL server instance. Selectivity is the percentage &hellip;">
  

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  
  <link rel="canonical" href="http://www.x2q.net/blog/page/4">
  <link href="/favicon.png" rel="icon">
  <link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
  <link href="/atom.xml" rel="alternate" title="x2q dot net" type="application/atom+xml">
  <script src="/javascripts/modernizr-2.0.js"></script>
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
  <script>!window.jQuery && document.write(unescape('%3Cscript src="./javascripts/lib/jquery.min.js"%3E%3C/script%3E'))</script>
  <script src="/javascripts/octopress.js" type="text/javascript"></script>
  <!--Fonts from Google"s Web font directory at http://google.com/webfonts -->
<link href="http://fonts.googleapis.com/css?family=PT+Serif:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">
<link href="http://fonts.googleapis.com/css?family=PT+Sans:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css">

  
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-120957-15']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>


</head>

<body   >
  <header role="banner"><hgroup>
  <h1><a href="/">x2q dot net</a></h1>
  
    <h2>note to self</h2>
  
</hgroup>

</header>
  <nav role="navigation"><ul class="subscription" data-subscription="rss">
  <li><a href="/atom.xml" rel="subscribe-rss" title="subscribe via RSS">RSS</a></li>
  
</ul>
  
<form action="http://google.com/search" method="get">
  <fieldset role="search">
    <input type="hidden" name="q" value="site:www.x2q.net" />
    <input class="search" type="text" name="q" results="0" placeholder="Search"/>
  </fieldset>
</form>
  
<ul class="main-navigation">
  <li><a href="/">Blog</a></li>
  <li><a href="/blog/archives">Archives</a></li>
  <li><a href="/about/">About</a></li>
</ul>

</nav>
  <div id="main">
    <div id="content">
      <div class="blog-index">
  
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/04/16/mysql-identify-worst-performing-indexes/">MySQL: Identify the Worst Performing Indexes</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-04-16T09:56:45+02:00" pubdate data-updated="true">Apr 16<span>th</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><span class='pullquote-right' data-pullquote='Index Selectivity = Number of Distinct Values / Total Number of Rows'>
This script shows the Top 10 worst performing indexes (in terms of selectivity %) on the whole <a href="http://en.wikipedia.org/wiki/MySQL">MySQL</a> server instance. Selectivity is the percentage of distinct values in an indexed field compared to the number of records in the table. When constructing indexes, you want to create indexes on columns that have a good chance of &#8220;high selectivity&#8221;. This requires some understanding of the data in the column, which you may or may not have depending on your knowledge of the domain and the availability of sample data. Keep in mind that selectivity is Index Selectivity = Number of Distinct Values / Total Number of Rows
</span></p>

<p>Lets consider a table &#8220;People&#8221; with three columns;  name, surname, gender, and age.</p>

<p>For example, creating an index on a column such as gender (where gender is constrained to (NULL), M or F) would not provide much benefit during a query (especially if the query already results in a table scan for other reasons). In any scenario, the selectivity of this index would be extremely low. Depending on the database, using this index may actually be worse that a full table scan.</p>

<p>However, creating a composite index on (name , surname) would provide benefits when executing queries against those columns. The selectivity of this index (for most populations) would be pretty good.</p>

<p>An index with selectivity of 1 is the ideal, however, the only way to achieve a selectivity of 1 is to have a unique index on a non-nullable column.</p>

<p>In general we say, that indexes help us to search the rows faster, however</p>

<ol>
<li>If the index column is <strong><em>not used for searches</em></strong> there is no point in defining it.</li>
<li>If the values in that column <strong><em>keep changing</em></strong> very frequently it will be extra work for database server (for re-indexing)</li>
<li>If there are <strong><em>too many inserts and deletes</em></strong> from table it will be extra work for server</li>
</ol>


<p><strong>Query to Identify The Worst Performing Indexes</strong></p>

<p>Note that this query can take some time to complete on servers with lots of databases or lots of tables.</p>

<div><script src='https://gist.github.com/635219.js'></script>
<noscript><pre><code>/*
SQL script to grab the worst performing indexes
in the whole server
*/
SELECT
  t.TABLE_SCHEMA AS `db`
 , t.TABLE_NAME AS `table`
 , s.INDEX_NAME AS `inde name`
 , s.COLUMN_NAME AS `field name`
 , s.SEQ_IN_INDEX `seq in index`
 , s2.max_columns AS `# cols`
 , s.CARDINALITY AS `card`
 , t.TABLE_ROWS AS `est rows`
 , ROUND(((s.CARDINALITY / IFNULL(t.TABLE_ROWS, 0.01)) * 100), 2) AS `sel %`
FROM INFORMATION_SCHEMA.STATISTICS s
 INNER JOIN INFORMATION_SCHEMA.TABLES t
  ON s.TABLE_SCHEMA = t.TABLE_SCHEMA
  AND s.TABLE_NAME = t.TABLE_NAME
 INNER JOIN (
  SELECT 
     TABLE_SCHEMA
   , TABLE_NAME
   , INDEX_NAME
   , MAX(SEQ_IN_INDEX) AS max_columns
  FROM INFORMATION_SCHEMA.STATISTICS
  WHERE TABLE_SCHEMA != 'mysql'
  GROUP BY TABLE_SCHEMA, TABLE_NAME, INDEX_NAME
 ) AS s2
 ON s.TABLE_SCHEMA = s2.TABLE_SCHEMA
 AND s.TABLE_NAME = s2.TABLE_NAME
 AND s.INDEX_NAME = s2.INDEX_NAME
WHERE t.TABLE_SCHEMA != 'mysql'                         /* Filter out the mysql system DB */
AND t.TABLE_ROWS &gt; 10                                   /* Only tables with some rows */
AND s.CARDINALITY IS NOT NULL                           /* Need at least one non-NULL value in the field */
AND (s.CARDINALITY / IFNULL(t.TABLE_ROWS, 0.01)) &lt; 1.00 /* Selectivity &lt; 1.0 b/c unique indexes are perfect anyway */
ORDER BY `sel %`, s.TABLE_SCHEMA, s.TABLE_NAME          /* Switch to `sel %` DESC for best non-unique indexes */
LIMIT 10;</code></pre></noscript></div>


<p>Example output on a MySQL server with a few wordpress databases.</p>

<figure class='code'><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class='line-number'>1</span>
<span class='line-number'>2</span>
<span class='line-number'>3</span>
<span class='line-number'>4</span>
<span class='line-number'>5</span>
<span class='line-number'>6</span>
<span class='line-number'>7</span>
<span class='line-number'>8</span>
<span class='line-number'>9</span>
<span class='line-number'>10</span>
<span class='line-number'>11</span>
<span class='line-number'>12</span>
<span class='line-number'>13</span>
<span class='line-number'>14</span>
<span class='line-number'>15</span>
</pre></td><td class='code'><pre><code class=''><span class='line'>x2q@x2q:~$ mysql --table -u x2q -p &lt; mysql-worst-indexes.sql
</span><span class='line'>+-----+------------------+---------------------------+------------------+--------------+--------+------+----------+-------+
</span><span class='line'>| db  | table            | index name                | field name       | seq in index | # cols | card | est rows | sel % |
</span><span class='line'>+-----+------------------+---------------------------+------------------+--------------+--------+------+----------+-------+
</span><span class='line'>| aa  | wp_commentmeta   | meta_key                  | meta_key         |            1 |      1 |    0 |     1360 |  0.00 |
</span><span class='line'>| aa1 | wp_commentmeta   | meta_key                  | meta_key         |            1 |      1 |    6 |    14023 |  0.04 |
</span><span class='line'>| aa  | wp_comments      | comment_approved_date_gmt | comment_approved |            1 |      2 |    1 |     2213 |  0.05 |
</span><span class='line'>| aa  | wp_comments      | comment_parent            | comment_parent   |            1 |      1 |    1 |     2213 |  0.05 |
</span><span class='line'>| aa  | wp_postmeta      | meta_value                | meta_value       |            1 |      1 |    1 |     1693 |  0.06 |
</span><span class='line'>| aa  | wp_term_taxonomy | taxonomy                  | taxonomy         |            1 |      1 |    2 |     3548 |  0.06 |
</span><span class='line'>| aa  | wp_posts         | post_related              | post_name        |            1 |      2 |    1 |      808 |  0.12 |
</span><span class='line'>| aa  | wp_posts         | yarpp_title               | post_title       |            1 |      1 |    1 |      808 |  0.12 |
</span><span class='line'>| aa  | wp_posts         | post_author               | post_author      |            1 |      1 |    1 |      808 |  0.12 |
</span><span class='line'>| aa  | wp_posts         | yarpp_content             | post_content     |            1 |      1 |    1 |      808 |  0.12 |
</span><span class='line'>+-----+------------------+---------------------------+------------------+--------------+--------+------+----------+-------+</span></code></pre></td></tr></table></div></figure>



</div>
  
  


    </article>
  
  
    <article>
      
  <header>
    
      <h1 class="entry-title"><a href="/blog/2010/04/03/hack-wireless-network/">How to Hack a Wireless Network</a></h1>
    
    
      <p class="meta">
        








  


<time datetime="2010-04-03T19:29:24+02:00" pubdate data-updated="true">Apr 3<span>rd</span>, 2010</time>
        
      </p>
    
  </header>


  <div class="entry-content"><p><a href="http://en.wikipedia.org/wiki/Wired_Equivalent_Privacy">WEP</a> was intended to provide comparable confidentiality to a traditional wired network (in particular it does not protect users of the network from each other, but from outsiders), hence the name WEP.</p>

<p>Despite the intention, several serious weaknesses were identified by <a href="http://en.wikipedia.org/wiki/Cryptanalysis">cryptanalysts</a> over the last years. The severity of the weaknesses means that any WEP protected network can be cracked using the right software within two minutes or less.</p>

<p>WEP was superseded by <a href="http://en.wikipedia.org/wiki/Wi-Fi_Protected_Access">Wi-Fi Protected Access</a> (also known as WPA) in 2003, and then by the full <a href="http://en.wikipedia.org/wiki/IEEE_802.11i-2004">IEEE 802.11i</a> standard (also known as WPA2) in 2004. Despite the weaknesses, WEP provides a level of security that can deter casual snooping.</p>

<p><strong>Hack Versus Crack</strong></p>

<p>For your information - just to get the right jargon.</p>

<p>The Eric S. Raymonds <a href="http://www.catb.org/jargon">Jargon File</a> contains a bunch of definitions of the term &#8221;<a href="http://en.wikipedia.org/wiki/Hacker_%28computer_security%29">hacker</a>&#8221;, most having to do with technical adeptness and a delight in solving problems and overcoming limits. The basic difference between a hacker and a cracker is this: hackers build things, crackers break them.</p>

<p><strong>Howto Conduct The Actual Crack</strong></p>

<p>It&#8217;s fairly easy to <a href="http://en.wikipedia.org/wiki/Password_cracking">crack</a> a <a href="http://en.wikipedia.org/wiki/Wired_Equivalent_Privacy">WEP</a> encrypted <a href="http://en.wikipedia.org/wiki/Wi-Fi">wireless network</a>, because the <a href="http://en.wikipedia.org/wiki/Wired_Equivalent_Privacy">WEP encryption</a> has some serious flaws in its design, flaws that makes it easy and fast to <a href="http://en.wikipedia.org/wiki/Password_cracking">crack</a> or hack.</p>

<p>Install <a href="http://www.aircrack-ng.org/">aircrack-ng</a> - on Debian or Ubuntu by:</p>

<pre><code>sudo aptitude install aircrack-ng
</code></pre>

<p>Then start aircrack-ng to look for wireless networks:</p>

<pre><code>sudo airodump-ng eth1
</code></pre>

<p>Then notice the channel number of the wireless network you want to crack.</p>

<pre><code>CH  1 ][ Elapsed: 9 mins ][ 2012-08-19 18:35

BSSID              PWR  Beacons    #Data, #/s  CH  MB   ENC  CIPHER AUTH ESSID

70:71:BC:A6:FF:FF  -68      285      191    0   4  54e  WEP  WEP         wifi-0
00:17:9A:F1:FF:FF  -77      599      104    0   6  54 . WEP  WEP         wifi-1
4C:E6:76:C4:FF:FF  -38      926       60    0   2  54e  WPA2 CCMP   PSK  wifi-2
C4:3D:C7:34:FF:FF  -62      476      397    0   8  54e  WPA  TKIP   PSK  wifi-3
</code></pre>

<p>Quit aircrack-ng and start it again with med specific channel number to collect packages faster:</p>

<pre><code>sudo airodump-ng -c 4 -w dump eth1
</code></pre>

<p>Then wait and let it collect about 500K IVS and the try the do the actual crack:</p>

<pre><code>sudo aircrack-ng -b 0a:0b:0c:0d:0e:0f dump-01.cap
</code></pre>

<p>The MAC after the -b option is the BSSID of the target and dump-01.cap the file containing the captured packets.</p>

<p><strong>Only WEP Encrypted Networks</strong></p>

<p>Keep in mind that this approach is only usable in relation to WEP encrypted wireless networks, and cannot be used to crack WPA and WPA2 encrypted networks.</p>

<p>However, there is a new project called <a href="http://code.google.com/p/pyrit/">Pyrit</a>,which is currently under it&#8217;s way. Pyrit takes a step ahead in attacking WPA-PSK and WPA2-PSK, the protocol that today de-facto protects public <a href="http://en.wikipedia.org/wiki/Wi-Fi">WIFI</a>-airspace. The project&#8217;s goal is to estimate the real-world security provided by these protocols. Pyrit does not provide <a href="http://en.wikipedia.org/wiki/Binary_file">binary</a> files or wordlists and does not encourage anyone to participate or engage in any harmful activity. This is a research project, not a cracking tool - keep that in mind ;-)</p>

<p>Pyrit&#8217;s implementation allows to create massive databases, pre-computing part of the WPA/WPA2-PSK authentication phase in a space-time-tradeoff. The performance gain for real-world-attacks is in the range of three orders of magnitude which urges for re-consideration of the protocol&#8217;s security. Exploiting the computational power of <a href="http://en.wikipedia.org/wiki/Graphics_processing_unit">GPUs</a>, this is currently by far the most powerful attack against one of the world&#8217;s most used security-protocols.</p>
</div>
  
  


    </article>
  
  <div class="pagination">
    
    <a href="/blog/archives">Blog Archives</a>
    
    <a class="next" href="/blog/page/3/">Newer &rarr;</a>
    
  </div>
</div>
<aside class="sidebar">
  
    <section>
  <h1>Recent Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2013/04/10/howto-install-office-2010-using-wine/">Howto Install Office 2010 using Wine</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/02/24/howto-backup-wd-mybook-live-to-amazon-s3-and-glacier/">Howto Backup WD MyBook Live to Amazon S3 and Glacier</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/02/23/howto-run-netflix-on-ubuntu-linux/">Howto run Netflix on Ubuntu Linux</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/01/31/howto-use-amazon-rds-from-heroku/">Howto use Amazon RDS from Heroku</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/01/30/howto-setup-pdf-printer-on-linux/">Howto Setup PDF Printer on Linux</a>
      </li>
    
  </ul>
</section>
<section>
  <h1>Popular Posts</h1>
  <ul id="recent_posts">
    
      <li class="post">
        <a href="/blog/2010/04/03/hack-wireless-network/">How to Hack a Wireless Network</a>
      </li>
    
      <li class="post">
        <a href="/blog/2013/01/14/rip-aaron-swartz/">RIP Aaron Swartz</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/12/01/fast-static-sites-with-ruby-on-heroku-slash-cedar/">Fast Static Sites with Ruby on Heroku/Cedar</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/11/20/pretty-printing-xml-with-xmllint/">Pretty Printing XML with xmllint</a>
      </li>
    
      <li class="post">
        <a href="/blog/2012/10/23/mac-os-x-drivers-for-the-hp-color-laserjet-1600/">Mac OS X Drivers for the HP Color LaserJet 1600</a>
      </li>
    
  </ul>
</section>

  
</aside>

    </div>
  </div>
  <footer role="contentinfo"><p>
  Copyright &copy; 2013 - x2q -
  <span class="credit">Powered by <a href="http://octopress.org">Octopress</a></span>
</p>

</footer>
  

<script type="text/javascript">
      var disqus_shortname = 'x2q';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>







  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = 'http://platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>





</body>
</html>
